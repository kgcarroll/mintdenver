(function(){"use strict";var e=$("#checkboxes"),t=$("#checkboxes-container"),n=null,a=[],i=false,r=false,l=$("#mobile-label"),o=$("#mobile-category-overlay"),f,s,u=$("#search-form"),d=u.find("input"),c="ALL",h,p,m=new Date,v,g=$("#unit-detail"),b=g.find("img"),y=$("#unit-detail-wrapper"),R=null,k=[],x=[];m.setHours(0,0,0,0);v=m.getTime();function F(e){return typeof e!="undefined"}function w(e){if(typeof e!=undefined&&e!=null){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}else{return""}}function D(e){return!isNaN(parseFloat(e))&&isFinite(e)}function I(){P();return false}function P(){var e=d.serializeArray();x=[];$.map(e,function(e,t){var n=e.name.replace("[]","");if(typeof x[n]=="undefined"){x[n]=[]}x[n].push(e.value)});f=new Date(x["move-in-date"][0]);if(f.getTime()!=s){s=f.getTime();Z()}else{G()}}function A(e){var t=new Date(e);t=t.getTime()<v?v:t.getTime();return t<=s}function N(e){if(e!=""){e="#"+e}var t=floorPlansURL+e;$("#share-buttons span").each(function(){var e=$(this).attr("st_url");if(typeof e!==typeof undefined&&e!==false){$(this).attr("st_url",t)}});document.location.hash=e}function M(e){if(F(x["unit-type"])&&x["unit-type"][0]!=""&&x["unit-type"][0]!="0"&&F(e.FloorPlanGroupName)){var t=false;for(var n=0;n<x["unit-type"].length;n++){var a=x["unit-type"][n];for(var i in k[a]){if(k[a][i]==e.FloorPlanGroupName){t=true}}}if(!t){return false}}if(F(e.units)){var r=[];for(var l=0;l<e.units.length;l++){var o=e.units[l];var f=true;if(F(o.Availability.MadeReadyDate)){f=A(o.Availability.MadeReadyDate);if(F(x["max-rent"])&&x["max-rent"][0]!=""&&F(o.BaseRentAmount)&&parseInt(o.BaseRentAmount)>=x["max-rent"][0]){f=false}}else{f=false}r.push(f)}for(var i=0;i<r.length;i++){if(r[i]){return true}}}return false}function U(e){for(var t=0;t<n.length;t++){if(F(n[t].FloorPlanID)&&n[t].FloorPlanID==e){return n[t]}}}function L(){$("#share-info-wrapper").fadeToggle()}function C(e){var t=F(e.Address)&&F(e.Address.UnitNumber)?e.Address.UnitNumber:"",n=$("#move-in-date").val(),a=F(e.BaseRentAmount)?w(parseInt(e.BaseRentAmount)):"",i=F(e.UnitDetails)&&F(e.UnitDetails.RentSqFtCount)?e.UnitDetails.RentSqFtCount:"",r=F(e.Address)&&F(e.Address.UnitID)?e.Address.UnitID:"",l=$("#available-unit-template").clone();if(F(t)){if(t.substring(0,1)=="0"){t=t.substring(1)}l.attr({id:"unit-"+t});l.find(".apt span").html(t);l.css("display","block")}if(F(a)){l.find(".rent span").html("$"+a)}if(F(i)){l.find(".sqft span").html(w(i))}if(F(r)){if(n.length==0){var o=f.getDate();var s=f.getMonth()+1;var u=f.getFullYear();if(o<10){o="0"+o}if(s<10){s="0"+s}n=s+"/"+o+"/"+u}if(typeof leaseOnlineURL!="undefined"){var d=F(r)?leaseOnlineURL+"?MoveInDate="+n+"&UnitId="+r+"&SearchUrl="+document.location:"";l.find(".availability a").attr("href",d)}}return l}function B(){var e=g.find(".left"),t=e.height(),n=e.width();b.css({"max-height":t,"max-width":n})}function O(){if(r&&$("#header").css("position")==="fixed"){var e=$(document).scrollTop(),t=e-y.offset().top+$("#header").height()-20;if(t<0){t=0}if(t+b.height()<y.outerHeight()-70){b.css("top",t)}}else{b.css("top","")}}function T(){var e=g.find(".left img").outerHeight()+20,t=g.find(".right").outerHeight(),n=e>t?e:t;if(n>600){y.css("height",n)}else{y.css("height","")}}function S(e){var t=e.unitsAvailable,n=$("#available-units"),a=[],i=e.Bathrooms,l=e.Bedrooms,o="",f=e.FloorPlanID,s=e.FloorPlanName,u=e.RentMin!=e.RentMax?w(parseInt(e.RentMin))+" - "+w(parseInt(e.RentMax)):w(parseInt(e.RentMax)),d=e.RentableSquareFootage,c=e.FloorPlanGroupName;N(f);r=true;if(F(s)){var h=s.toUpperCase();g.find("img").attr("src",templateURL+"/images/floor-plans/MINT_"+h+".jpg");$("#unit-pdf-link").attr("href",templateURL+"/pdfs/"+h+".pdf");g.find(".name").html(s)}if(F(l)){var p=l>0?"<span>"+l+"</span> Bed":"Studio";if(F(c)){c=c.toLowerCase();o=c.indexOf("den")>-1?"Den":"";if(o!=""){p+=" with Den"}}g.find(".beds").html(p)}if(F(i)){g.find(".baths span").html(i)}if(F(d)){g.find(".sqft span").html(w(d))}if(F(u)){g.find(".rent span").html("$"+u)}g.find(".available-count span").html(t);n.html("");if(F(e.units)&&t>0){for(var m=0;m<e.units.length;m++){var v=C(e.units[m]);a.push(v[0])}n.append(a).show()}else{n.hide()}y.fadeIn(function(){B();$("html,body").animate({scrollTop:0},250)});$("#unit-detail-background").fadeIn()}function j(){$("#unit-detail-background").fadeOut();$("#unit-detail-wrapper").fadeOut();N("");r=false}function q(e){var t=e.unitsAvailable,n=e.Bathrooms,a=e.Bedrooms,i="",r=e.FloorPlanName,l=e.RentMin!=e.RentMax?w(parseInt(e.RentMin))+" - "+w(parseInt(e.RentMax)):w(parseInt(e.RentMax)),o=e.RentableSquareFootage,f=e.FloorPlanGroupName,s=$("#result-template").clone();if(F(f)){f=f.toLowerCase();s.attr({id:"unit-type-"+r,class:"unit-type-tr"});s.find(".name").html(r);i=f.indexOf("den")>-1?"Den":""}if(F(a)){var u=a>0?a+" Bed":"Studio";if(F(n)&&n>0){u+=" / "+n+" Bath"}s.find(".bedbath").html(u)}if(i!=""){s.find(".den").html(i)}if(F(o)){s.find(".sqft").html(w(o))}if(F(l)){s.find(".rent").html("$"+l)}if(t>0){s.find(".availability").html(t+" Available")}s.find("button").on({click:function(){S(e)}});return s}function G(){var e=false,t=false,a=true,r=$("#results-table"),l=$("#results"),o=$("#no-results"),f=[];r.html(" ");if(h.length>0){e=true}for(var s in n){if(e&&n[s].FloorPlanID==h){S(n[s]);t=true}var u=M(n[s]);if(u!==false){var d=q(n[s]);f.push(d[0]);t=true}if(a){$("#loader").fadeOut();a=false}}if(t){if(o.length){o.hide()}l.fadeIn();$.fn.append.apply(r,f).html();if(!i){$("#results").tablesorter({sortList:[[0,0]]});i=true}else{$("#results").trigger("update")}}else{l.hide();if(o.length){o.fadeIn()}}}function H(){d=u.find("input");d.unbind("change keyup paste");d.on("change keyup paste",function(){I()})}function z(e){switch(e){case"eff":return"studio";break;default:return e;break}}function E(e){var t=["zero","one","two","three","four","five","six","seven","eight","nine"];return t[e]}function J(e){var t=e.toLowerCase(),n=E(t.substring(0,1));if(t.indexOf("eff")>-1){n="Studio"}else if(t.indexOf("1bd")>-1){n="1BR"}else if(t.indexOf("2bd")>-1){n="2BR"}else if(t.indexOf("3bd")>-1){n="3BR"}else if(t.indexOf("all")>-1){n="All"}return n}function _(t,n){var a=k[t][0],i=$(document.createElement("input")),r=$(document.createElement("div")),f=$(document.createElement("label")),s="checkbox-container",u=a.split("/"),d=a.replace(/\//g,"-");i.attr({id:d,type:"radio",name:"unit-type",value:t});if(n){i.attr({checked:"checked"});r.addClass("active")}i.on({click:function(){var t=e.find(".checkbox-container");t.removeClass("active");r.addClass("active");if(o.is(":visible")){e.find("input").not(this).attr("checked",false);o.trigger("click");l.hide();$(".checkbox-container").removeClass("active");if($(this).is(":checked")){$(this).parent(".checkbox-container").addClass("active")}else{l.show()}}c=a}});f.html(J(a));f.attr({for:d});if(u.length>0){var h="type-"+z(u[0].toLowerCase());s+=" "+h;f.addClass(h)}r.addClass(s);r.append(i,f);return r}function Y(){e.html("");var t=[];k.unshift(["ALL"]);for(var n in k){if(k[n].length>0){var a=_(n,c==k[n][0]);t.push(a[0])}}e.append(t);H()}function K(e){var t=[];for(var n=0;n<R.length;n++){if(typeof R[n].FloorPlan!="undefined"&&typeof R[n].FloorPlan.FloorPlanName!="undefined"&&R[n].FloorPlan.FloorPlanName==e){t.push(R[n])}}return t}function Q(){for(var e=0;e<n.length;e++){if(typeof n[e].FloorPlanID!="undefined"){var t=n[e].FloorPlanName;var i=K(t),r=0;if(i.length>0){for(var l=0;l<i.length;l++){if(typeof i[l].Availability.MadeReadyDate!="undefined"&&A(i[l].Availability.MadeReadyDate)){r+=1}}}n[e].unitsAvailable=r;n[e].units=i;if(typeof a[t]=="undefined"){a[t]=n[e]}}}V();G()}function V(){for(var e in a){if(typeof a[e].FloorPlanGroupName!="undefined"){var t=a[e].FloorPlanGroupName;var n=t.toLowerCase().substring(0,1);switch(n){case"e":n=0;break;default:n=parseInt(n);break}if(typeof k[n]=="undefined"){k[n]=[]}if($.inArray(t,k[n])<0&&(typeof a[e].units!="undefined"&&a[e].units.length>0)){k[n].push(t)}}}Y()}function W(){a=[];k=[];Q()}function X(){$.ajax({cache:false,url:templateURL+"/JSON/mintRealPageFloorPlans.json",dataType:"json",success:function(e){n=e;if(R!=null){W()}}});$.ajax({cache:false,url:templateURL+"/JSON/mintRealPageUnits.json",dataType:"json",success:function(e){R=e;if(n!=null){W()}}})}function Z(){$("#results-table").html(" ");$("#loader").fadeIn();var e=f.getFullYear()+"-"+(f.getMonth()+1)+"-"+f.getDate();$.ajax({cache:false,url:"/realPageAPIunitsJSON.php?date="+e,dataType:"json",success:function(e){R=e;if(n!=null){W()}}})}function ee(){u.on({submit:function(){return I()}});$("#unit-detail-background,#unit-detail-close-button").on({click:function(){j()}});$("#share-button,#share-close-button,#share-info-background").on({click:function(){L()}});o.on("click",function(){t.toggleClass("show")})}$(document).ready(function(){h=window.location.hash.replace("#","");X();p=new Date(2017,10,1,0,0,0);if(p.getTime()<v){p=m}else{m=p}s=p.getTime();ee();$("#move-in-date").datepicker({minDate:m})});$(window).on({load:function(){if(r){B()}},resize:function(){if(r){B();T()}},scroll:function(){if(r){}}})})();